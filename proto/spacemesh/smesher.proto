syntax = "proto3";
package spacemesh;
import "google/protobuf/empty.proto";
import "spacemesh/types.proto";
import "spacemesh/smesher_types.proto";

// Readonly basic node data
service SmesherService {

    // Smeshing state - is the node setup to smesh or not?
    rpc SmeshingState(google.protobuf.Empty) returns (SmeshingState);

    // Get post commitment data
    rpc PostData(google.protobuf.Empty) returns (PostCommitmentData);

    // Returns a list of available post init processors (including CPU as fallback)
    rpc PostInitProcessor(google.protobuf.Empty) returns (PostProcessors);

    // Start post commitment init phsae
    rpc StartPostInit(PostUserData) returns (BoolResult);

    // About ongoing post commitment init phase and optionally attempt to delete commitment file(s)
    rpc AbortPostInit(DeleteCommitment) returns (BoolResult);

    // Start smeshing
    rpc StartSmeshing(google.protobuf.Empty) returns (BoolResult);

    // Stop smeshing and optionally attempt to delete post init file(s)
    rpc StopSmeshing(DeleteCommitment) returns (BoolResult);

    // Coinbase commands
    rpc Coinbase(google.protobuf.Empty) returns (AccountId);
    rpc SetCoinbase(AccountId) returns (BoolResult);

    // Get the current smesher id generated by the node
    rpc SmesherId(google.protobuf.Empty) returns (AccountId);

    //// Streams

    // A stream of updates to the post commitment file. e.g. bytes written to commitment file during init phase
    rpc PostInitDataStream(google.protobuf.Empty) returns (PostCommitmentData);

}
